using System;
using System.Collections.Generic;

class Program
{
    static List<int> DfsWithStack(Dictionary<int, List<int>> graph, int start)
    {
        var stack = new Stack<int>(); // Стек для хранения вершин
        var visited = new HashSet<int>(); // Множество для отслеживания посещённых вершин
        var result = new List<int>(); // Список для записи порядка обхода

        stack.Push(start); // Добавить начальную вершину в стек

        while (stack.Count > 0)
        {
            var node = stack.Pop(); // Достать вершину из стека

            if (!visited.Contains(node))
            {
                visited.Add(node); // Отметить вершину как посещенную
                result.Add(node); // Добавить вершину в результат

                // Добавить в стек соседей в обратном порядке
                // чтобы при обходе использовался правильный порядок
                foreach (var neighbor in graph[node])
                {
                    if (!visited.Contains(neighbor))
                    {
                        stack.Push(neighbor);
                    }
                }
            }
        }

        return result;
    }

    static void Main()
    {
        // Пример графа
        var graph = new Dictionary<int, List<int>>()
        {
            { 1, new List<int> { 2, 3 } },
            { 2, new List<int> { 1, 3 } },
            { 3, new List<int> { 1, 2 } },
            { 4, new List<int> { 5 } },
            { 5, new List<int> { 4 } },
            { 6, new List<int> { } }
        };

        var result = DfsWithStack(graph, 1); // Запуск DFS с вершины 1

        Console.WriteLine("Порядок обхода с использованием стека:");
        foreach (var node in result)
        {
            Console.WriteLine(node);
        }
    }
}
